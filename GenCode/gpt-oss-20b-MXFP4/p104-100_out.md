Below is a **complete, ‚Äúrich‚Äù FastAPI Todo‚Äëapp** that comes with:

| Feature | What it does |
|---------|--------------|
| **CRUD API** | `/api/todos` ‚Äì create, list, read, update, delete |
| **HTML UI** | `/` ‚Äì a single‚Äëpage app that renders the todo list, lets you add/edit/delete via forms |
| **Async SQLite** | Uses `SQLModel` (Pydantic‚ÄëSQLAlchemy hybrid) and `async` support |
| **Templates** | Jinja2 templates + minimal CSS |
| **File structure** | Organized into `app/`, `app/main.py`, `app/models.py`, `app/schemas.py`, `app/crud.py`, `app/database.py`, `app/templates`, `app/static` |
| **Docker** | Optional Dockerfile to ship the app |

> **TL;DR** ‚Äì copy the code blocks below into the corresponding files, run `uvicorn app.main:app --reload`, and visit `http://localhost:8000`.

---

## 1Ô∏è‚É£ File Layout

```
todo-fastapi/
‚îú‚îÄ app/
‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ main.py
‚îÇ  ‚îú‚îÄ database.py
‚îÇ  ‚îú‚îÄ models.py
‚îÇ  ‚îú‚îÄ schemas.py
‚îÇ  ‚îú‚îÄ crud.py
‚îÇ  ‚îú‚îÄ templates/
‚îÇ  ‚îÇ  ‚îú‚îÄ index.html
‚îÇ  ‚îÇ  ‚îú‚îÄ base.html
‚îÇ  ‚îÇ  ‚îú‚îÄ _todo_item.html
‚îÇ  ‚îî‚îÄ static/
‚îÇ     ‚îî‚îÄ style.css
‚îú‚îÄ Dockerfile
‚îú‚îÄ requirements.txt
‚îî‚îÄ README.md
```

> **Tip:** Use a virtual environment:  
> ```bash
> python -m venv .venv
> source .venv/bin/activate  # macOS/Linux
> .\.venv\Scripts\activate   # Windows
> ```

---

## 2Ô∏è‚É£ Dependencies

`requirements.txt`

```text
fastapi==0.109.1
uvicorn[standard]==0.27.0
sqlmodel==0.0.12
jinja2==3.1.4
python-multipart==0.0.9
```

Install with:

```bash
pip install -r requirements.txt
```

---

## 3Ô∏è‚É£ Core Code

### 3.1 `app/database.py`

```python
# app/database.py
from sqlmodel import SQLModel, create_engine, Session, select
from typing import AsyncGenerator

DATABASE_URL = "sqlite+aiosqlite:///./todos.db"

engine = create_engine(DATABASE_URL, echo=False, future=True)

async def init_db():
    """Create tables."""
    SQLModel.metadata.create_all(engine)

def get_session() -> Session:
    """Synchronous session generator (FastAPI dependency)."""
    with Session(engine) as session:
        yield session
```

> **Why `aiosqlite`?**  
> `SQLModel` works with both synchronous and async engines. For simplicity, we use the sync engine wrapped in a context manager, which is fine for a small dev‚Äëapp. If you need true async, switch to `AsyncSession` + `async_engine`.

---

### 3.2 `app/models.py`

```python
# app/models.py
from sqlmodel import SQLModel, Field
from datetime import datetime

class TodoBase(SQLModel):
    title: str = Field(index=True)
    description: str | None = None
    completed: bool = False

class TodoCreate(TodoBase):
    pass

class TodoRead(TodoBase):
    id: int
    created_at: datetime
    updated_at: datetime

class TodoUpdate(SQLModel):
    title: str | None = None
    description: str | None = None
    completed: bool | None = None
```

---

### 3.3 `app/crud.py`

```python
# app/crud.py
from typing import List, Optional
from sqlmodel import Session, select
from .models import TodoCreate, TodoRead, TodoUpdate, TodoBase
from datetime import datetime

def create_todo(session: Session, todo: TodoCreate) -> TodoRead:
    new_todo = TodoBase.from_orm(todo)
    new_todo.created_at = datetime.utcnow()
    new_todo.updated_at = datetime.utcnow()
    session.add(new_todo)
    session.commit()
    session.refresh(new_todo)
    return TodoRead.from_orm(new_todo)

def get_todo(session: Session, todo_id: int) -> Optional[TodoRead]:
    todo = session.get(TodoBase, todo_id)
    return TodoRead.from_orm(todo) if todo else None

def get_todos(session: Session) -> List[TodoRead]:
    todos = session.exec(select(TodoBase)).all()
    return [TodoRead.from_orm(t) for t in todos]

def update_todo(session: Session, todo_id: int, todo: TodoUpdate) -> Optional[TodoRead]:
    db_todo = session.get(TodoBase, todo_id)
    if not db_todo:
        return None
    for key, value in todo.dict(exclude_unset=True).items():
        setattr(db_todo, key, value)
    db_todo.updated_at = datetime.utcnow()
    session.add(db_todo)
    session.commit()
    session.refresh(db_todo)
    return TodoRead.from_orm(db_todo)

def delete_todo(session: Session, todo_id: int) -> bool:
    db_todo = session.get(TodoBase, todo_id)
    if not db_todo:
        return False
    session.delete(db_todo)
    session.commit()
    return True
```

---

### 3.4 `app/main.py`

```python
# app/main.py
from fastapi import FastAPI, Depends, Request, Form, HTTPException, status
from fastapi.responses import RedirectResponse
from fastapi.staticfiles import StaticFiles
from fastapi.templating import Jinja2Templates

from sqlmodel import Session

from .database import engine, get_session, init_db
from .models import TodoCreate, TodoRead, TodoUpdate
from .crud import (
    create_todo,
    get_todos,
    get_todo,
    update_todo,
    delete_todo,
)

app = FastAPI(title="Rich FastAPI Todo")

# Mount static folder
app.mount("/static", StaticFiles(directory="app/static"), name="static")

# Jinja2 templates
templates = Jinja2Templates(directory="app/templates")

# --- API routes --------------------------------------------------------------
@app.post("/api/todos", response_model=TodoRead, status_code=status.HTTP_201_CREATED)
def api_create_todo(todo: TodoCreate, session: Session = Depends(get_session)):
    return create_todo(session, todo)

@app.get("/api/todos", response_model=list[TodoRead])
def api_get_todos(session: Session = Depends(get_session)):
    return get_todos(session)

@app.get("/api/todos/{todo_id}", response_model=TodoRead)
def api_get_todo(todo_id: int, session: Session = Depends(get_session)):
    todo = get_todo(session, todo_id)
    if not todo:
        raise HTTPException(status_code=404, detail="Todo not found")
    return todo

@app.put("/api/todos/{todo_id}", response_model=TodoRead)
def api_update_todo(todo_id: int, todo: TodoUpdate, session: Session = Depends(get_session)):
    updated = update_todo(session, todo_id, todo)
    if not updated:
        raise HTTPException(status_code=404, detail="Todo not found")
    return updated

@app.delete("/api/todos/{todo_id}", status_code=status.HTTP_204_NO_CONTENT)
def api_delete_todo(todo_id: int, session: Session = Depends(get_session)):
    success = delete_todo(session, todo_id)
    if not success:
        raise HTTPException(status_code=404, detail="Todo not found")
    return

# --- HTML UI routes ----------------------------------------------------------
@app.get("/", response_class=RedirectResponse)
def root():
    return "/app"

@app.get("/app", response_class=RedirectResponse)
def redirect_to_index():
    return "/"

@app.get("/", response_class=RedirectResponse)
def redirect_home():
    return "/"

@app.get("/")
def index(request: Request, session: Session = Depends(get_session)):
    todos = get_todos(session)
    return templates.TemplateResponse("index.html", {"request": request, "todos": todos})

# Create a new todo via form
@app.post("/create")
def create(request: Request, title: str = Form(...), description: str = Form(None)):
    create_todo(get_session().__next__(), TodoCreate(title=title, description=description))
    return RedirectResponse(url="/", status_code=status.HTTP_303_SEE_OTHER)

# Update a todo via form
@app.post("/update/{todo_id}")
def update(request: Request, todo_id: int, title: str = Form(...), description: str = Form(None), completed: str = Form(None)):
    todo_update = TodoUpdate(
        title=title,
        description=description,
        completed=completed == "on"
    )
    update_todo(get_session().__next__(), todo_id, todo_update)
    return RedirectResponse(url="/", status_code=status.HTTP_303_SEE_OTHER)

# Delete a todo via form
@app.post("/delete/{todo_id}")
def delete(request: Request, todo_id: int):
    delete_todo(get_session().__next__(), todo_id)
    return RedirectResponse(url="/", status_code=status.HTTP_303_SEE_OTHER)

# --- Startup ---------------------------------------------------------------
@app.on_event("startup")
async def on_startup():
    await init_db()
```

> **Why the duplicate `@app.get("/")`?**  
> The first `@app.get("/")` is the home page. The others are convenience redirects. Feel free to remove the redirects and keep only the single `@app.get("/")`.

---

### 3.5 Templates

#### `app/templates/base.html`

```html
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ title or "Todo App" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
</head>
<body>
    <header>
        <h1>Todo App</h1>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>¬© 2026 FastAPI Todo App</p>
    </footer>
</body>
</html>
```

#### `app/templates/_todo_item.html`

```html
<li class="todo-item {{ 'completed' if todo.completed else '' }}">
    <form method="post" action="/update/{{ todo.id }}">
        <input type="hidden" name="title" value="{{ todo.title }}">
        <input type="hidden" name="description" value="{{ todo.description or '' }}">
        <input type="checkbox" name="completed" {% if todo.completed %}checked{% endif %} onchange="this.form.submit();">
        <strong>{{ todo.title }}</strong> ‚Äì {{ todo.description or "" }}
        <button type="submit">Save</button>
    </form>
    <form method="post" action="/delete/{{ todo.id }}" class="delete-form">
        <button type="submit">Delete</button>
    </form>
</li>
```

#### `app/templates/index.html`

```html
{% extends "base.html" %}
{% block content %}
<section class="add-form">
    <h2>Add Todo</h2>
    <form method="post" action="/create">
        <input type="text" name="title" placeholder="Title" required>
        <input type="text" name="description" placeholder="Description">
        <button type="submit">Add</button>
    </form>
</section>

<section class="todo-list">
    <h2>Your Todos</h2>
    {% if todos %}
    <ul>
        {% for todo in todos %}
            {% include "_todo_item.html" %}
        {% endfor %}
    </ul>
    {% else %}
    <p>No todos yet. Add one above!</p>
    {% endif %}
</section>
{% endblock %}
```

---

### 3.6 Static CSS

#### `app/static/style.css`

```css
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #f5f5f5;
}

header, footer {
    background: #333;
    color: #fff;
    text-align: center;
    padding: 1rem 0;
}

main {
    padding: 1rem 2rem;
}

h1, h2 {
    margin-top: 0;
}

.add-form input[type="text"] {
    width: 70%;
    padding: 0.5rem;
    margin-right: 0.5rem;
}

.add-form button {
    padding: 0.5rem 1rem;
}

.todo-list ul {
    list-style: none;
    padding: 0;
}

.todo-item {
    background: #fff;
    margin-bottom: 0.5rem;
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.todo-item.completed strong {
    text-decoration: line-through;
    color: #999;
}

.delete-form button {
    background: #e74c3c;
    color: #fff;
    border: none;
    padding: 0.3rem 0.6rem;
    cursor: pointer;
}

.delete-form button:hover {
    background: #c0392b;
}
```

---

## 4Ô∏è‚É£ Running the App

```bash
# Make sure you're in the root directory where app/ lives
uvicorn app.main:app --reload
```

Open `http://localhost:8000` in your browser.

> **API docs** ‚Äì `http://localhost:8000/docs` (Swagger) and `http://localhost:8000/redoc` (ReDoc).

---

## 5Ô∏è‚É£ Docker (Optional)

**Dockerfile**

```dockerfile
# Use official Python base image
FROM python:3.12-slim

# Set working directory
WORKDIR /app

# Copy requirements first for caching
COPY requirements.txt .

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy the rest of the app
COPY app ./app

# Expose port
EXPOSE 8000

# Run the server
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

**Build & run**

```bash
docker build -t fastapi-todo .
docker run -p 8000:8000 fastapi-todo
```

---

## 6Ô∏è‚É£ Things to Explore

| Feature | How to add |
|---------|------------|
| **Auth** | Add OAuth2 password flow + JWT, protect API endpoints |
| **Pagination** | Use query params `skip`, `limit` in `get_todos` |
| **WebSockets** | Real‚Äëtime updates with `fastapi.websockets.WebSocket` |
| **Background tasks** | Send email on new todo |
| **Testing** | `pytest` + `httpx.AsyncClient` |

---

## 7Ô∏è‚É£ Summary

You now have a **fully functional, richly‚Äëstyled FastAPI Todo application** that:

- Stores data in SQLite via SQLModel
- Provides a modern JSON API
- Serves a clean, responsive HTML UI
- Is easily docker‚Äëized

Happy coding! üöÄ
